<!DOCTYPE html>
<html>

<head>

<title>UB Bargain Lab</title>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<script>

fetch('prado.csv')
.then(response => response.text())
.then(data => {

let lines = data.trim().split('\n');

let headers = lines[0].split(',');

let priceIndex = headers.indexOf('price_1');
let manIndex = headers.indexOf('man_date');

let dataset=[];

for(let i=1;i<lines.length;i++){

// safer CSV split
let cols = lines[i].match(/(".*?"|[^",\s]+)(?=\s*,|\s*$)/g);

if(!cols) continue;

let price=parseFloat(cols[priceIndex]);
let year=parseInt(cols[manIndex]);

if(!isNaN(price) && !isNaN(year)){

dataset.push({

x:year,
y:price

});

}

}

const ctx=document.getElementById('chart');

new Chart(ctx,{

type:'scatter',

data:{

datasets:[{

label:'Price vs Manufacture Year',

data:dataset

}]

},

options:{

scales:{

x:{
title:{
display:true,
text:'Manufacture Year'
}
},

y:{
title:{
display:true,
text:'Price'
}
}

}

}

});

});

</script>
fetch('prado.csv')

.then(response => response.text())

.then(data => {

let rows = data.split('\n').slice(1);

let labels=[];
let prices=[];
let manufacture=[];
let imported=[];
let engines=[];

rows.forEach(row=>{

let cols=row.split(',');

// IMPORTANT:
// check column order matches CSV

let price=cols[36]; // price_1
let man=cols[38]; // man_date
let imp=cols[39]; // import_date
let engine=cols[42]; // engine

if(price){

labels.push(man); // show manufacture year

prices.push(parseFloat(price));

manufacture.push(man);

imported.push(imp);

engines.push(engine);

}

});

const ctx=document.getElementById('chart');

new Chart(ctx,{

type:'line',

data:{

labels:labels,

datasets:[{

label:'Prado Price (â‚®)',

data:prices

}]

}

});

});

</script>

</body>

</html>
