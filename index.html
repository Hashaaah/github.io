<!DOCTYPE html>
<html>

<head>

<title>UB Bargain Lab</title>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>

fetch('./prado.csv')

.then(response => response.text())

.then(data => {

let rows = data.trim().split('\n');

// header row
let headers = rows[0]
.split(',')
.map(h => h.trim());

// find column numbers automatically
let priceIndex = headers.indexOf('price_1');
let manIndex = headers.indexOf('man_date');
let importIndex = headers.indexOf('import_date');
let engineIndex = headers.indexOf('engine');

console.log(priceIndex, manIndex);

let labels=[];
let prices=[];

rows.slice(1).forEach(row=>{

let cols = row.split(',');

let price = cols[priceIndex];
let man = cols[manIndex];

if(!price || !man) return;

// remove ₮ or spaces if exist
price = price.replace(/[^\d]/g,'');

price = parseFloat(price);

if(!isNaN(price)){

labels.push(man);

prices.push(price);

}

});

const ctx=document.getElementById('chart');

new Chart(ctx,{

type:'line',

data:{

labels:labels,

datasets:[{

label:'Prado Price vs Manufacture Year',

data:prices

}]

}

});

});

</script>
  
fetch('prado.csv')

.then(response => response.text())

.then(data => {

let rows = data.split('\n').slice(1);

let labels=[];
let prices=[];
let manufacture=[];
let imported=[];
let engines=[];

rows.forEach(row=>{

let cols=row.split(',');

// IMPORTANT:
// check column order matches CSV

let price=cols[36]; // price_1
let man=cols[38]; // man_date
let imp=cols[39]; // import_date
let engine=cols[42]; // engine

if(price){

labels.push(man); // show manufacture year

prices.push(parseFloat(price));

manufacture.push(man);

imported.push(imp);

engines.push(engine);

}

});

const ctx=document.getElementById('chart');

new Chart(ctx,{

type:'line',

data:{

labels:labels,

datasets:[{

label:'Prado Price (₮)',

data:prices

}]

}

});

});

</script>

</body>

</html>
